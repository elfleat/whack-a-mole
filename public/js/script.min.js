"use strict";function getRandom(e,t){return Math.floor(Math.random()*(t-e))+e}var Library={Scoreboard:function(){var s="whack-a-moleScores",e={elfleat:48,jvaldes:16,mvanhouten:8,spierre:21};return this.init=function(){return this.get()||localStorage.setItem(s,JSON.stringify(e)),this},this.get=function(){return JSON.parse(localStorage.getItem(s))},this.saveScore=function(e,t){var r=this.get();return r[e]=t,localStorage.setItem(s,JSON.stringify(r)),!0},this.init()},Timer:function(e,t,r){var s=r;this.queryElements=function(){return this.el=e,this};var i=setInterval(function(){s-=1,this.updateTime(),0===s&&(this.stopTimer(),t())}.bind(this),1e3);return this.stopTimer=function(){clearInterval(i)},this.updateTime=function(){return this.el.innerText=s,this},this.queryElements().updateTime()},Modal:function(t){return this.queryElements=function(){var e=document.getElementById(t.container);return this.els={container:e,closeBtn:e.querySelector(".modal-close"),trigger:document.getElementById(t.trigger),overlay:document.querySelector(".modal-overlay")},this},this.bindEvents=function(){return this.els.closeBtn.addEventListener("click",this.close.bind(this)),this.els.overlay.addEventListener("click",this.close.bind(this)),this.els.trigger.addEventListener("click",this.open.bind(this)),this},this.open=function(){return this.render&&this.render(this.els),this.els.container.classList.add("is-open"),this.els.container.setAttribute("aria-modal",!0),this}.bind(this),this.close=function(){return this.els.container.classList.remove("is-open"),this.els.container.setAttribute("aria-modal",!1),this},this.queryElements().bindEvents()},GameApp:function(t){this.modules={},this.appState={screen:"intro",score:0};var r=function(e){return this.appState.screen&&this.els.body.classList.remove("app-state-"+this.appState.screen),this.appState.screen=e,this.els.body.classList.add("app-state-"+this.appState.screen),this}.bind(this);return this.queryElements=function(){var e=document.getElementById(t.appContainer);return this.els={body:document.body,appContainer:e,leaderboardModalContainer:e.querySelector("#"+t.leaderboard),playNowBtn:e.querySelector("#"+t.playNowBtn),timerSeconds:e.querySelector("#"+t.timerSeconds),scorePoints:e.querySelector("#"+t.scorePoints),gameViewport:e.querySelector("#"+t.gameViewport),craters:document.querySelectorAll("."+t.craters),saveNameBtn:e.querySelector("#"+t.saveNameBtn),nameInput:e.querySelector("#"+t.nameInput),gameOverScore:e.querySelector("#"+t.gameOverScore)},this},this.bindEvents=function(){return this.els.playNowBtn.addEventListener("click",this.startGame.bind(this)),this.els.gameViewport.addEventListener("click",function(e){e.target.classList.contains("is-out")&&(this.addPoints(),e.target.classList.remove("is-out"))}.bind(this)),this.els.saveNameBtn.addEventListener("click",function(e){e.preventDefault();var t=this.els.nameInput.value;if(!t.length)return alert("Please enter your name.");r("intro"),this.modules.scoreBoard.saveScore(t,this.appState.score),this.appState.score=0,this.modules.leaderboardModal.open()}.bind(this)),this},this.initApp=function(){return r("intro"),this.modules.scoreBoard=Library.Scoreboard(),this.modules.leaderboardModal=new window.Library.Modal({container:"leaderboard-modal",trigger:"wam-leaderboard-cta",leaderboard:"leaderboard-modal"},this.modules.scoreBoard),this.modules.leaderboardModal.render=this.renderLeaderBoard.bind(this),this},this.renderLeaderBoard=function(e){var s=this.modules.scoreBoard.get(),i="";Object.keys(s).forEach(function(e){var t,r;i+=(r=s[t=e],'<li class="leaderboard-item"><span class="leaderboard-item-user">'+t+'</span><span class="leaderboard-item-points">'+r+"</span></li>")}),e.container.querySelector(".leaderboard-table").innerHTML=i},this.addPoints=function(){return this.appState.score+=4,this.els.scorePoints.innerText=this.appState.score,this},this.toggleMole=function(){var e=this.els.craters[getRandom(0,this.els.craters.length)];e.classList.add("is-out"),setTimeout(function(){e.classList.remove("is-out")}.bind(this),1200)},this.setUpCrater=function(e){setTimeout(this.toggleMole.bind(this),e)},this.startGame=function(){var e=0;for(r("game"),this.modules.timer=new Library.Timer(this.els.timerSeconds,this.endGame.bind(this),30);e<20;)this.setUpCrater(1e3*getRandom(0,30)),e++;return this},this.endGame=function(){this.els.gameOverScore.innerText=this.appState.score,r("game-over")},this.queryElements().bindEvents().initApp()}};window.Library=Library,console.info("Welcome to Whack-a-Mole."),window.app=new Library.GameApp({appContainer:"wam-app",playNowBtn:"wam-play-cta",timerSeconds:"game-countdown-secs",scorePoints:"game-score-points",gameViewport:"game-screen",craters:"game-mole",saveNameBtn:"save-name-cta",nameInput:"game-over-name",gameOverScore:"game-over-score"});
